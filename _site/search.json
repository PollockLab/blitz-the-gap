[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Challenges",
    "section": "",
    "text": "Blitz the Gap is a Canada-wide bioblitz to help us fill gaps in our knowledge of biodiversity in Canada. Canada is a large country and hosts tons of amazing biodiversity - which makes it a challenging place to survey. Though we’ve made progress thanks to community science platforms like iNaturalist, we are still lacking data for a whole host of ecological and conservation applications.\nTo assess at-risk species, track the changes in species’ ranges due to climate change, rapidly detect species losses and invasions, we just need more data - and that’s how you can help!\n \n    \n  \n    \n     iNaturalist\n  \n  \n    \n     Blitz the Gap\n  \n\n\n  \n\n\n\nChallenges\nTo Blitz the Gap, choose from a series of challenges to fill biodiversity data gaps in Canada, according to what inspires you the most. These challenges were designed by graduate students throughout Canada to help guide iNaturalists like you towards places that deserve a little more attention. Remember: even one observation can be enough to make a difference in our understanding of biodiversity change.\nReady? Set? Blitz the Gap!\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCanada’s Most Wanted\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nChallenge title\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nClosing the Climate Gap\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nConservation Priorities in Canada (MayBAs)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMore than the Monarch\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRevisiting the past\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSeaweeds of Canada\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nToo Hot to Handle!\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrailblazers challenge\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "workflows/tutorial.html",
    "href": "workflows/tutorial.html",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "This is an example workflow to identify gaps in a biodiversity database (like GBIF or iNaturalist), and to generate raster maps where each cell is assigned a priority level for sampling in a bioblitz event.\nEach map will cross biodiversity priorities with accessibility to identify the cells that are easiest to sample while helping to fill a biodiversity data gap. Gaps will be defined based on “Challenges” that will be part of the Blitz the Gap event.\nHere, we will build an example challenge to encourage community scientists to update historical records of amphibians.\n\n\nLoad packages:\n\nlibrary(dplyr) \nlibrary(tidyr)\nlibrary(terra)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(mapview)\nlibrary(raster)\nlibrary(here)\n\nSet some mapview options to apply to all the maps we will make here:\n\nmapviewOptions(basemaps = c(\"OpenStreetMap\"),\n               na.color = \"transparent\")\n\n\n\nLoad spatial layers that we will use to make sure all of our layers match (in terms of the grid resolution and projection).\n\n# Canada polygon\ncanada = sf::read_sf(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/canada-polygon/canada.outline.shp\")\n\n# Base grid for rasterizing\nbase.5k = terra::rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/canada.base.5k.tiff\")\n\n# Mask water and built areas\nbase.water &lt;- rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/WaterUrbanBuiltMask.tif\")\nbase.water&lt;-project(base.water, crs(base.5k))\nbase.water&lt;-resample(base.water, base.5k, method='near')\nterra::writeRaster(base.water, here::here(\"data/clean/base-layers/WaterUrbanBuiltMask.tif\"), overwrite=TRUE)\n\n# Make a reverse of the base layer to remove cells that we don't want to consider (later)\nanti.base=base.5k\nanti.base[is.na(anti.base)] &lt;- 1\nanti.base[anti.base==2] &lt;- NA\nanti.base[base.water==1] &lt;- 1\nterra::writeRaster(anti.base, here::here(\"data/clean/base-layers/anti.base.5k.tif\"), overwrite = TRUE)\n\n\n\n\nThis tutorial will use GBIF data, though later steps will be similarly useful to process iNaturalist data. Here, let’s use a download of all amphibian data in Canada.\n\n# Download the GBIF data through the GBIF data website. Make sure to save the citation details from the download in a text file alongside the data.\n# Unzip in the data/raw/gbif/your_taxa_of_choice folder\n# Read in the dataset and select columns we need\ngbif = data.table::fread(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/biodiversity-data/amphibians/0007149-250127130748423.csv\") |&gt;\n  dplyr::filter(coordinateUncertaintyInMeters &lt; 100000) |&gt;\n  dplyr::select(family, scientificName, year,\n         decimalLongitude, decimalLatitude, coordinatePrecision,\n         datasetKey, basisOfRecord)\n\nFirst, we need to prepare the GBIF data into a spatial object:\n\n# Convert GBIF to a points layer\ngbif.v &lt;- vect(gbif,\n               geom=c(\"decimalLongitude\",\"decimalLatitude\"),\n             crs=\"+proj=longlat +ellps=WGS84\",\n             keepgeom = TRUE)\n\n# Project GBIF \ngbif.v &lt;- project(gbif.v, crs(base.5k))\n\n# Remove occurrences outside the canada polygon\ngbif.v = terra::crop(gbif.v, canada)\n\nNow we can convert the GBIF data into raster layers:\n\ngbif.density: count of GBIF observations per cell\nmuseum.density: count of GBIF observations from preserved specimens (museums) per cell\niNat.density: count of GBIF observations from iNaturalist (dataset key: \"50c9509d-22c7-4a22-a47d-8c48425ef4a7\") per cell\nyear.last.sampled: year of the last GBIF observation in GBIF per cell\n\n\n# Make a GBIF density layer\ngbif.density &lt;- rasterize(gbif.v, base.5k, fun=\"count\")\n\n# Density of museum observations\nmuseum.density &lt;- rasterize(gbif.v[which(gbif.v$basisOfRecord == \"PRESERVED_SPECIMEN\")], base.5k, fun=\"count\")\n\n# Density of observations from iNaturalist alone\niNat.density &lt;- rasterize(gbif.v[which(gbif.v$datasetKey == \"50c9509d-22c7-4a22-a47d-8c48425ef4a7\")], base.5k, fun=\"count\")\n\n# Raster of the latest observation's year\nyear.last.sampled &lt;- rasterize(gbif.v, base.5k, fun=\"max\", field=\"year\")\n\n# Stack the GBIF layers into one object for easy saving\ngbif.layers = c(gbif.density,museum.density,iNat.density,year.last.sampled)\nnames(gbif.layers) = c(\"gbif.density\",\"museum.density\",\"iNat.density\",\"year.last.sampled\")\ngbif.layers[is.na(base.5k)]&lt;-NA\n\n# save\nwriteRaster(gbif.layers, here::here(\"data/clean/biodiversity-data/rasters/gbif.layers.amphibians.tif\"), overwrite = TRUE)\nwriteVector(gbif.v, here::here(\"data/clean/biodiversity-data/points/gbif.points.amphibians.shp\"), overwrite = TRUE)\n\n\n\n\n\nMany of these layers are originally from the GEOBON STAC catalog, which can be viewed here: https://stac.geobon.org/viewer/. Instructions about how to retrieve these layers and download them for use are here: Working with STAC.\nThis is some code to reproject and resample the rasters from the STAC to match the GBIF density layers, after downloading them following the instructions linked above.\n\n\nClimate velocity (a metric of how quickly the climate will change by 2085 in each cell, under RCP85):\n\nvel &lt;- rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/challenges/climate/climatevelocity_adaptwest_fwvel_ensemble_rcp85_2085.tif\")\nvel&lt;-project(vel,base.5k,\"bilinear\")\nvel&lt;-resample(vel,base.5k,method='near')\nvel[is.na(base.5k)] &lt;- NA\nterra::writeRaster(vel, here::here(\"data/clean/challenges/climate/climatevelocity_adaptwest_fwvel_ensemble_rcp85_2085.tif\"), overwrite=TRUE)\n\n\n\n\nDistance to roads:\n\ndist.to.roads&lt;-rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/distance.to.roads.tif\")\ndist.to.roads&lt;-project(dist.to.roads,base.5k,\"bilinear\")\ndist.to.roads[is.na(base.5k)]&lt;-NA\nterra::writeRaster(dist.to.roads, here::here(\"data/clean/base-layers/dist.to.roads.tif\"),overwrite = TRUE)\n\n\n\n\n\n\n\n\n# Copy the layer into a new object that we'll edit\nresamp &lt;- gbif.layers$year.last.sampled\nmapview(resamp, \n        na.color = \"transparent\")\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\nNext, we will assign priority values to cells based on the year they were last sampled. These are the priority levels we will use:\n\n\n\nPriority\nOldest observation\nNewest observation\n\n\n\n\nHigh (1)\noldest\n1950\n\n\nMedium (2)\n1951\n2000\n\n\nLow (3)\n2001\n2015\n\n\nNot a priority (4)\n2016\n2025\n\n\n\nLet’s assign these values based on the condition that the year last sampled in GBIF is within those year limits:\n\nresamp[gbif.layers$year.last.sampled &lt;= 1950] &lt;- 1\nresamp[gbif.layers$year.last.sampled &gt; 1950 & gbif.layers$year.last.sampled &lt;= 2000] &lt;- 2\nresamp[gbif.layers$year.last.sampled &gt; 2000 & gbif.layers$year.last.sampled &lt;= 2015] &lt;- 3\nresamp[gbif.layers$year.last.sampled &gt; 2015] &lt;- 4\n\nLet’s map this to see what we’re working with!\n\nmapview(resamp)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\n\n\n\nLet’s make a mask of the pixels we consider to be accessible. Let’s say anything within 10 km of a major road is potentially accessible, so we’re only interested in these cells:\n\nd10 = dist.to.roads\nd10[d10&gt;10000] &lt;- NA # assign NA to pixels that are over 10 km away from a major road\nmapview(d10)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\nNow, we can use this same condition (ignore anything where dist.to.roads &gt; 10000) to select cells from the priority layer that are accessible:\n\npal = viridis::viridis(n = 3, direction = -1)\npriority = resamp\npriority[dist.to.roads &gt; 10000] &lt;- NA\nmapview(priority, \n        col.regions = pal)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\n\n\n\nLet’s visualize this a little differently, so it is easier to explore. We will make a point layer with the year in which the cell was last sampled, and this layer is resized as we zoom in and out so it is easier to have a quick view of the map. When we zoom in, we will see the cell the point is referring to, so we make sure we’re still identifying the exact cell outline that we’d be asking people to go sample.\n\nlast.year = gbif.layers$year.last.sampled\nlast.year[priority &gt; 3] &lt;- NA\nlast.year[dist.to.roads &gt; 10000] &lt;- NA\n\nhistorical_pts = last.year |&gt;\n  raster::raster() |&gt;\n  raster::rasterToPoints(fun = function(x){x&lt;2016}, spatial = TRUE)\n\nhistorical_cells = priority |&gt;\n  raster::raster() |&gt;\n  raster::rasterToPolygons(fun = function(x){x &lt; 4})\n\npal = viridis::viridis(n = 3, direction = -1)\n(m = mapview(historical_cells, \n        legend = TRUE, \n        basemaps = \"OpenStreetMap\",  \n        col.regions = pal,\n        layer.name = \"Priority\") +\n  mapview(historical_pts,\n          col.regions = pal,\n          legend = FALSE, \n          layer.name = \"Year last \\nsampled\"))\n\nWarning: Found less unique colors (3) than unique zcol values (80)! \nInterpolating color vector to match number of zcol values.\n\n\n\n\n\n\n\nhtmlwidgets::saveWidget(m@map, \n                        file = here::here(\"challenges/maps/challenge1_map.html\"), \n                        title = \"Revisit the past: Amphibians\")\n\n\n\n\n\nTo make a project on iNaturalist that includes observations within polygons, we need to convert our raster into a KML file. From this KML file, we can make a “Place” on iNaturalist, which we can then set up for each challenge.\nFirst, we will convert our raster to polygons using the raster package:\n\n# make a raster layer to convert \npriority_map = priority\n# remove lowest priority level to only have 3 levels\npriority_map[priority &gt; 3] &lt;- NA\n\n# convert raster to polygons\nhistorical_poly = raster::raster(priority_map) |&gt;\n  raster::rasterToPolygons(n = 4, \n                           na.rm = TRUE)\n\n## Merge polygons that are touching into one polygon\n# convert to sf object\nhistorical_poly = sf::st_as_sf(historical_poly) \n\n# write polygons as a kml file\nsf::st_write(historical_poly, \n             driver = \"KML\", \n             dsn = here::here(\"data/outputs/kml/historical-amphibians.kml\"),\n             delete_layer = TRUE) # overwrite existing layer\n\nWriting layer `historical-amphibians' to data source \n  `/Users/katherine/Documents/GitHub/blitz-the-gap/data/outputs/kml/historical-amphibians.kml' using driver `KML'\n\n\nWarning in CPL_write_ogr(obj, dsn, layer, driver,\nas.character(dataset_options), : GDAL Message 1: Layer name\n'historical-amphibians' adjusted to 'historical_amphibians' for XML validity.\n\n\nWriting 435 features with 1 fields and geometry type Polygon."
  },
  {
    "objectID": "workflows/tutorial.html#step-1.-prepare-gbif-data-and-make-density-layers",
    "href": "workflows/tutorial.html#step-1.-prepare-gbif-data-and-make-density-layers",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "Load packages:\n\nlibrary(dplyr) \nlibrary(tidyr)\nlibrary(terra)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(mapview)\nlibrary(raster)\nlibrary(here)\n\nSet some mapview options to apply to all the maps we will make here:\n\nmapviewOptions(basemaps = c(\"OpenStreetMap\"),\n               na.color = \"transparent\")\n\n\n\nLoad spatial layers that we will use to make sure all of our layers match (in terms of the grid resolution and projection).\n\n# Canada polygon\ncanada = sf::read_sf(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/canada-polygon/canada.outline.shp\")\n\n# Base grid for rasterizing\nbase.5k = terra::rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/canada.base.5k.tiff\")\n\n# Mask water and built areas\nbase.water &lt;- rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/WaterUrbanBuiltMask.tif\")\nbase.water&lt;-project(base.water, crs(base.5k))\nbase.water&lt;-resample(base.water, base.5k, method='near')\nterra::writeRaster(base.water, here::here(\"data/clean/base-layers/WaterUrbanBuiltMask.tif\"), overwrite=TRUE)\n\n# Make a reverse of the base layer to remove cells that we don't want to consider (later)\nanti.base=base.5k\nanti.base[is.na(anti.base)] &lt;- 1\nanti.base[anti.base==2] &lt;- NA\nanti.base[base.water==1] &lt;- 1\nterra::writeRaster(anti.base, here::here(\"data/clean/base-layers/anti.base.5k.tif\"), overwrite = TRUE)\n\n\n\n\nThis tutorial will use GBIF data, though later steps will be similarly useful to process iNaturalist data. Here, let’s use a download of all amphibian data in Canada.\n\n# Download the GBIF data through the GBIF data website. Make sure to save the citation details from the download in a text file alongside the data.\n# Unzip in the data/raw/gbif/your_taxa_of_choice folder\n# Read in the dataset and select columns we need\ngbif = data.table::fread(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/biodiversity-data/amphibians/0007149-250127130748423.csv\") |&gt;\n  dplyr::filter(coordinateUncertaintyInMeters &lt; 100000) |&gt;\n  dplyr::select(family, scientificName, year,\n         decimalLongitude, decimalLatitude, coordinatePrecision,\n         datasetKey, basisOfRecord)\n\nFirst, we need to prepare the GBIF data into a spatial object:\n\n# Convert GBIF to a points layer\ngbif.v &lt;- vect(gbif,\n               geom=c(\"decimalLongitude\",\"decimalLatitude\"),\n             crs=\"+proj=longlat +ellps=WGS84\",\n             keepgeom = TRUE)\n\n# Project GBIF \ngbif.v &lt;- project(gbif.v, crs(base.5k))\n\n# Remove occurrences outside the canada polygon\ngbif.v = terra::crop(gbif.v, canada)\n\nNow we can convert the GBIF data into raster layers:\n\ngbif.density: count of GBIF observations per cell\nmuseum.density: count of GBIF observations from preserved specimens (museums) per cell\niNat.density: count of GBIF observations from iNaturalist (dataset key: \"50c9509d-22c7-4a22-a47d-8c48425ef4a7\") per cell\nyear.last.sampled: year of the last GBIF observation in GBIF per cell\n\n\n# Make a GBIF density layer\ngbif.density &lt;- rasterize(gbif.v, base.5k, fun=\"count\")\n\n# Density of museum observations\nmuseum.density &lt;- rasterize(gbif.v[which(gbif.v$basisOfRecord == \"PRESERVED_SPECIMEN\")], base.5k, fun=\"count\")\n\n# Density of observations from iNaturalist alone\niNat.density &lt;- rasterize(gbif.v[which(gbif.v$datasetKey == \"50c9509d-22c7-4a22-a47d-8c48425ef4a7\")], base.5k, fun=\"count\")\n\n# Raster of the latest observation's year\nyear.last.sampled &lt;- rasterize(gbif.v, base.5k, fun=\"max\", field=\"year\")\n\n# Stack the GBIF layers into one object for easy saving\ngbif.layers = c(gbif.density,museum.density,iNat.density,year.last.sampled)\nnames(gbif.layers) = c(\"gbif.density\",\"museum.density\",\"iNat.density\",\"year.last.sampled\")\ngbif.layers[is.na(base.5k)]&lt;-NA\n\n# save\nwriteRaster(gbif.layers, here::here(\"data/clean/biodiversity-data/rasters/gbif.layers.amphibians.tif\"), overwrite = TRUE)\nwriteVector(gbif.v, here::here(\"data/clean/biodiversity-data/points/gbif.points.amphibians.shp\"), overwrite = TRUE)"
  },
  {
    "objectID": "workflows/tutorial.html#step-2.-prepare-environmental-human-access-layers",
    "href": "workflows/tutorial.html#step-2.-prepare-environmental-human-access-layers",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "Many of these layers are originally from the GEOBON STAC catalog, which can be viewed here: https://stac.geobon.org/viewer/. Instructions about how to retrieve these layers and download them for use are here: Working with STAC.\nThis is some code to reproject and resample the rasters from the STAC to match the GBIF density layers, after downloading them following the instructions linked above.\n\n\nClimate velocity (a metric of how quickly the climate will change by 2085 in each cell, under RCP85):\n\nvel &lt;- rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/challenges/climate/climatevelocity_adaptwest_fwvel_ensemble_rcp85_2085.tif\")\nvel&lt;-project(vel,base.5k,\"bilinear\")\nvel&lt;-resample(vel,base.5k,method='near')\nvel[is.na(base.5k)] &lt;- NA\nterra::writeRaster(vel, here::here(\"data/clean/challenges/climate/climatevelocity_adaptwest_fwvel_ensemble_rcp85_2085.tif\"), overwrite=TRUE)\n\n\n\n\nDistance to roads:\n\ndist.to.roads&lt;-rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/distance.to.roads.tif\")\ndist.to.roads&lt;-project(dist.to.roads,base.5k,\"bilinear\")\ndist.to.roads[is.na(base.5k)]&lt;-NA\nterra::writeRaster(dist.to.roads, here::here(\"data/clean/base-layers/dist.to.roads.tif\"),overwrite = TRUE)"
  },
  {
    "objectID": "workflows/tutorial.html#step-3.-make-a-priority-map",
    "href": "workflows/tutorial.html#step-3.-make-a-priority-map",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "# Copy the layer into a new object that we'll edit\nresamp &lt;- gbif.layers$year.last.sampled\nmapview(resamp, \n        na.color = \"transparent\")\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\nNext, we will assign priority values to cells based on the year they were last sampled. These are the priority levels we will use:\n\n\n\nPriority\nOldest observation\nNewest observation\n\n\n\n\nHigh (1)\noldest\n1950\n\n\nMedium (2)\n1951\n2000\n\n\nLow (3)\n2001\n2015\n\n\nNot a priority (4)\n2016\n2025\n\n\n\nLet’s assign these values based on the condition that the year last sampled in GBIF is within those year limits:\n\nresamp[gbif.layers$year.last.sampled &lt;= 1950] &lt;- 1\nresamp[gbif.layers$year.last.sampled &gt; 1950 & gbif.layers$year.last.sampled &lt;= 2000] &lt;- 2\nresamp[gbif.layers$year.last.sampled &gt; 2000 & gbif.layers$year.last.sampled &lt;= 2015] &lt;- 3\nresamp[gbif.layers$year.last.sampled &gt; 2015] &lt;- 4\n\nLet’s map this to see what we’re working with!\n\nmapview(resamp)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\n\n\n\nLet’s make a mask of the pixels we consider to be accessible. Let’s say anything within 10 km of a major road is potentially accessible, so we’re only interested in these cells:\n\nd10 = dist.to.roads\nd10[d10&gt;10000] &lt;- NA # assign NA to pixels that are over 10 km away from a major road\nmapview(d10)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\nNow, we can use this same condition (ignore anything where dist.to.roads &gt; 10000) to select cells from the priority layer that are accessible:\n\npal = viridis::viridis(n = 3, direction = -1)\npriority = resamp\npriority[dist.to.roads &gt; 10000] &lt;- NA\nmapview(priority, \n        col.regions = pal)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\n\n\n\nLet’s visualize this a little differently, so it is easier to explore. We will make a point layer with the year in which the cell was last sampled, and this layer is resized as we zoom in and out so it is easier to have a quick view of the map. When we zoom in, we will see the cell the point is referring to, so we make sure we’re still identifying the exact cell outline that we’d be asking people to go sample.\n\nlast.year = gbif.layers$year.last.sampled\nlast.year[priority &gt; 3] &lt;- NA\nlast.year[dist.to.roads &gt; 10000] &lt;- NA\n\nhistorical_pts = last.year |&gt;\n  raster::raster() |&gt;\n  raster::rasterToPoints(fun = function(x){x&lt;2016}, spatial = TRUE)\n\nhistorical_cells = priority |&gt;\n  raster::raster() |&gt;\n  raster::rasterToPolygons(fun = function(x){x &lt; 4})\n\npal = viridis::viridis(n = 3, direction = -1)\n(m = mapview(historical_cells, \n        legend = TRUE, \n        basemaps = \"OpenStreetMap\",  \n        col.regions = pal,\n        layer.name = \"Priority\") +\n  mapview(historical_pts,\n          col.regions = pal,\n          legend = FALSE, \n          layer.name = \"Year last \\nsampled\"))\n\nWarning: Found less unique colors (3) than unique zcol values (80)! \nInterpolating color vector to match number of zcol values.\n\n\n\n\n\n\n\nhtmlwidgets::saveWidget(m@map, \n                        file = here::here(\"challenges/maps/challenge1_map.html\"), \n                        title = \"Revisit the past: Amphibians\")"
  },
  {
    "objectID": "workflows/tutorial.html#prepare-kml-file-for-inaturalist",
    "href": "workflows/tutorial.html#prepare-kml-file-for-inaturalist",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "To make a project on iNaturalist that includes observations within polygons, we need to convert our raster into a KML file. From this KML file, we can make a “Place” on iNaturalist, which we can then set up for each challenge.\nFirst, we will convert our raster to polygons using the raster package:\n\n# make a raster layer to convert \npriority_map = priority\n# remove lowest priority level to only have 3 levels\npriority_map[priority &gt; 3] &lt;- NA\n\n# convert raster to polygons\nhistorical_poly = raster::raster(priority_map) |&gt;\n  raster::rasterToPolygons(n = 4, \n                           na.rm = TRUE)\n\n## Merge polygons that are touching into one polygon\n# convert to sf object\nhistorical_poly = sf::st_as_sf(historical_poly) \n\n# write polygons as a kml file\nsf::st_write(historical_poly, \n             driver = \"KML\", \n             dsn = here::here(\"data/outputs/kml/historical-amphibians.kml\"),\n             delete_layer = TRUE) # overwrite existing layer\n\nWriting layer `historical-amphibians' to data source \n  `/Users/katherine/Documents/GitHub/blitz-the-gap/data/outputs/kml/historical-amphibians.kml' using driver `KML'\n\n\nWarning in CPL_write_ogr(obj, dsn, layer, driver,\nas.character(dataset_options), : GDAL Message 1: Layer name\n'historical-amphibians' adjusted to 'historical_amphibians' for XML validity.\n\n\nWriting 435 features with 1 fields and geometry type Polygon."
  },
  {
    "objectID": "challenges/Trailblazers_challenge.html",
    "href": "challenges/Trailblazers_challenge.html",
    "title": "Trailblazers challenge",
    "section": "",
    "text": "Did you know that most iNaturalist observations made by hikers are taken in close proximity to the trailhead? Having a more even spread in observations over the complete length of popular trails will provide researchers with a more representative view of the biodiversity that Canadians have access to."
  },
  {
    "objectID": "challenges/Trailblazers_challenge.html#whats-the-problem",
    "href": "challenges/Trailblazers_challenge.html#whats-the-problem",
    "title": "Trailblazers challenge",
    "section": "",
    "text": "Did you know that most iNaturalist observations made by hikers are taken in close proximity to the trailhead? Having a more even spread in observations over the complete length of popular trails will provide researchers with a more representative view of the biodiversity that Canadians have access to."
  },
  {
    "objectID": "challenges/Trailblazers_challenge.html#where-should-you-go",
    "href": "challenges/Trailblazers_challenge.html#where-should-you-go",
    "title": "Trailblazers challenge",
    "section": "Where should you go?",
    "text": "Where should you go?\nFor this challenge we encourage you to go stretch your legs in the most popular parks throughout Canada. Which species you observe is not important: the more the merrier. The only requirement is that you are located at least 1 km away from a trailhead or road.\nFor hiking inspiration you can look at the relevant park website!"
  },
  {
    "objectID": "challenges/Trailblazers_challenge.html#title-for-your-map",
    "href": "challenges/Trailblazers_challenge.html#title-for-your-map",
    "title": "Trailblazers challenge",
    "section": "Title for your map",
    "text": "Title for your map"
  },
  {
    "objectID": "challenges/Trailblazers_challenge.html#who-created-this-challenge",
    "href": "challenges/Trailblazers_challenge.html#who-created-this-challenge",
    "title": "Trailblazers challenge",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was created for Blitz the Gap, designed by Lukas Van Riel, a PhD student at Université de Montréal looking into how climate change will impact Canadian forests."
  },
  {
    "objectID": "challenges/climate_gaps_challenge.html#whats-the-problem",
    "href": "challenges/climate_gaps_challenge.html#whats-the-problem",
    "title": "Closing the Climate Gap",
    "section": "What’s the problem?",
    "text": "What’s the problem?\nCanada hosts a wide range of climates due to its vast size and diverse geography. Understanding how different climates contribute to the collective housing of biodiversity helps us make predictions about how biodiversity is adapted for its environment, and therefore how it might change in the future. Much of the biodiversity across complex and varied climates remains poorly understood, limiting our ability to describe biodiversity in the full range of climates across Canada.\nJoin the iNaturalist project!"
  },
  {
    "objectID": "challenges/climate_gaps_challenge.html#where-should-you-go",
    "href": "challenges/climate_gaps_challenge.html#where-should-you-go",
    "title": "Closing the Climate Gap",
    "section": "Where should you go?",
    "text": "Where should you go?\nTo bridge this gap, we encourage you to visit some areas that represent unique Canadian climates that have yet to be surveyed thoroughly. We’ve highlighted these areas across the country for you to choose from, which you can see on this map:\n\n\n\n\n\n\n\nWarning\n\n\n\nThe locations on this map are suggestions and not exact coordinates of where to sample. We cannot determine safety, ownership, or access to these lands. Please verify that you can legally and safely access these sites."
  },
  {
    "objectID": "challenges/climate_gaps_challenge.html#who-created-this-challenge",
    "href": "challenges/climate_gaps_challenge.html#who-created-this-challenge",
    "title": "Closing the Climate Gap",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was created by a team of ecologists, graduate students, and community scientists. This team includes scientists who study the effects of climate change on biodiversity and iNaturalist users like you who help collect the species occurrence data needed for this research. The Blitz-the-Gap umbrella project seeks to increase the number of iNaturalist observations that can be used for science and conservation (https://blitzthegap.org/), and is supported by: Canadian Wildlife Federation, Wildlife Conservation Society Canada, Canada Key Biodiversity Areas, Campus Biodiversity Network, University of British Columbia’s Data4Nature cluster, McGill University, and the Canadian Institute for Ecology and Evolution, including the Living Data Project.\nNicole Kester is a MSc student studying invasive plants and patterns of their spread into new climatic conditions.\nJoshua Lee is a PhD student studying how additional biodiversity metrics can be integrated into conservation management in Australia.\nBrian Starzomski is the Ian McTaggart Cowan Professor of Biodiversity Conservation and Ecological Restoration, and co-leads the BC Biodiversity project.\nDiane Srivastava leads the Living Data Project and studies how species and food webs respond to climate change and other environmental shifts.\nSandra Emry is a postdoctoral fellow with the Living Data Project, and studies the effects of heat waves and other disturbances on marine ecology.\nShirley Morrison is an avid iNaturalist user and contributor to the Butterflies in My Backyard Project (BIMBY).\nStephen Deedes-Vincke volunteers with the BIMBY project and is a Certified Pollinator Steward and Butterfly Ranger.\nMichelle Tseng is an Associate Professor who studies how climate change affects insect communities and aquatic food webs. She uses iNaturalist data extensively in her research, including the BIMBY data."
  },
  {
    "objectID": "challenges/Too_hot_to_handle_challenge.html#whats-the-problem",
    "href": "challenges/Too_hot_to_handle_challenge.html#whats-the-problem",
    "title": "Too Hot to Handle!",
    "section": "What’s the problem?",
    "text": "What’s the problem?\nCanada’s climate is warming quickly, but more so in some parts of the country than others. You can help scientists and communities track how species are responding to these changes by joining this Blitz-the-Gap project. Record species - any species - in these hotspots for climate change to help build the knowledge that scientists need to propose actions for conservation. We have already found for you the places in Canada that are easy to access, and warming the fastest, but where there are very few if any iNaturalist observations."
  },
  {
    "objectID": "challenges/Too_hot_to_handle_challenge.html#where-should-you-go",
    "href": "challenges/Too_hot_to_handle_challenge.html#where-should-you-go",
    "title": "Too Hot to Handle!",
    "section": "Where should you go?",
    "text": "Where should you go?\nAny locations on the map! These locations are the easiest way to make a difference in tracking species changes in response to climate warming.\n\nJoin the iNaturalist project!\n\n\n\n\n\n\nWarning\n\n\n\nThe locations on this map are suggestions and not exact coordinates of where to sample. We cannot determine safety, ownership, or access to these lands. Please verify that you can legally and safely access these sites."
  },
  {
    "objectID": "challenges/Too_hot_to_handle_challenge.html#who-created-this-challenge",
    "href": "challenges/Too_hot_to_handle_challenge.html#who-created-this-challenge",
    "title": "Too Hot to Handle!",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was created by a team of ecologists, graduate students, and community scientists. This team includes scientists who study the effects of climate change on biodiversity and iNaturalist users like you who help collect the species occurrence data needed for. The Blitz-the-Gap umbrella project seeks to increase the number of iNaturalist observations that can be used for science and conservation (https://blitzthegap.org/), and is supported by: Canadian Wildlife Federation, Wildlife Conservation Society Canada, Canada Key Biodiversity Areas, Campus Biodiversity Network, University of British Columbia’s Data4Nature cluster, McGill University, and the Canadian Institute for Ecology and Evolution, including the Living Data Project.\nJoshua Lee is a PhD student studying how additional biodiversity metrics can be integrated into conservation management in Australia.\nNicole Kester is a MSc student studying invasive plants and patterns of their spread into new climatic conditions.\nBrian Starzomski is the Ian McTaggart Cowan Professor of Biodiversity Conservation and Ecological Restoration, and co-leads the BC Biodiversity project.\nDiane Srivastava leads the Living Data Project and studies how species and food webs respond to climate change and other environmental shifts.\nSandra Emry is a postdoctoral fellow with the Living Data Project, and studies the effects of heat waves and other disturbances on marine ecology.\nShirley Morrison is an avid iNaturalist user and contributor to the Butterflies in My Backyard Project (BIMBY).\nStephen Deedes-Vincke volunteers with the BIMBY project and is a Certified Pollinator Steward and Butterfly Ranger.\nMichelle Tseng is an Associate Professor who studies how climate change affects insect communities and aquatic food webs. She uses iNaturalist data extensively in her research, including the BIMBY data."
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html",
    "href": "challenges/challenge1_revisit-the-past.html",
    "title": "Revisiting the past",
    "section": "",
    "text": "To understand biodiversity change, we need a record of biodiversity change. Join this challenge to help us bridge time gaps in biodiversity data!\nSome of the most valuable information we have from the past is from naturalists who spent hours in the field, looking for species they love. Unfortunately, fewer and fewer of us can invest our lives into observing nature in this way, though we may share a passion for nature and the outdoors. Gaps are appearing not just in space, but also in time: as data gets older, we become less certain that the species is still there. By revisiting past observations, we can better understand how biodiversity is changing to prevent biodiversity losses."
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html#whats-the-gap",
    "href": "challenges/challenge1_revisit-the-past.html#whats-the-gap",
    "title": "Revisiting the past",
    "section": "",
    "text": "To understand biodiversity change, we need a record of biodiversity change. Join this challenge to help us bridge time gaps in biodiversity data!\nSome of the most valuable information we have from the past is from naturalists who spent hours in the field, looking for species they love. Unfortunately, fewer and fewer of us can invest our lives into observing nature in this way, though we may share a passion for nature and the outdoors. Gaps are appearing not just in space, but also in time: as data gets older, we become less certain that the species is still there. By revisiting past observations, we can better understand how biodiversity is changing to prevent biodiversity losses."
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html#where-should-you-go",
    "href": "challenges/challenge1_revisit-the-past.html#where-should-you-go",
    "title": "Revisiting the past",
    "section": "Where should you go?",
    "text": "Where should you go?\nTo bridge this gap, we encourage you to revisit places that were sampled in the past. We’ve highlighted historically-sampled places that are close to roads for you to choose from, which you can see on these maps:"
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html#amphibians",
    "href": "challenges/challenge1_revisit-the-past.html#amphibians",
    "title": "Revisiting the past",
    "section": "Amphibians",
    "text": "Amphibians\n\n\n\n\n\n\n\nWarning\n\n\n\nThe locations on this map are suggestions and not exact coordinates of where to sample. We cannot determine safety, ownership, or access to these lands. Please verify that you can legally and safely access these sites."
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html#who-created-this-challenge",
    "href": "challenges/challenge1_revisit-the-past.html#who-created-this-challenge",
    "title": "Revisiting the past",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was the first one created for Blitz the Gap, designed by Laura Pollock, Isaac Eckert, Pierre Rogy, and Katherine Hébert. We are all part of the Quantitative Biodiversity Lab at McGill University led by Laura. We use data from sources like iNaturalist to build biodiversity models that help us understand and predict biodiversity and how it is changing."
  },
  {
    "objectID": "challenges/challenge-template.html",
    "href": "challenges/challenge-template.html",
    "title": "Challenge title",
    "section": "",
    "text": "[blurb about the gap you want to fill]"
  },
  {
    "objectID": "challenges/challenge-template.html#whats-the-problem",
    "href": "challenges/challenge-template.html#whats-the-problem",
    "title": "Challenge title",
    "section": "",
    "text": "[blurb about the gap you want to fill]"
  },
  {
    "objectID": "challenges/challenge-template.html#where-should-you-go",
    "href": "challenges/challenge-template.html#where-should-you-go",
    "title": "Challenge title",
    "section": "Where should you go?",
    "text": "Where should you go?\nTo bridge this gap, we encourage you to [visit sites / look for species that …]. We’ve highlighted [places…] for you to choose from, which you can see on these maps:"
  },
  {
    "objectID": "challenges/challenge-template.html#title-for-your-map",
    "href": "challenges/challenge-template.html#title-for-your-map",
    "title": "Challenge title",
    "section": "Title for your map",
    "text": "Title for your map\nWe’ll insert your html widget map here, like this:\n{=html, echo = TRUE, eval = FALSE} &lt;iframe width=\"900\" height=\"700\" src=\"maps/your_challenge_map.html\" title=\"YourTitle\"&gt;&lt;/iframe&gt;"
  },
  {
    "objectID": "challenges/challenge-template.html#who-created-this-challenge",
    "href": "challenges/challenge-template.html#who-created-this-challenge",
    "title": "Challenge title",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was created for Blitz the Gap, designed by [names]. [Some information about yourselves and how you use iNaturalist, or use their data in your own research, etc.]"
  },
  {
    "objectID": "workflows.html",
    "href": "workflows.html",
    "title": "Workflows",
    "section": "",
    "text": "Here are some tutorials to access and analyse iNaturalist Canada data to make Blitz the Gap challenges.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAccessing the STAC Catalogue\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMaking priority maps for Blitz the Gap\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUsing the iNaturalist Canada parquet file\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "challenges/challenge-Butterfly.html",
    "href": "challenges/challenge-Butterfly.html",
    "title": "More than the Monarch",
    "section": "",
    "text": "In Canada, we have more than 5,000 species recorded of butterflies and moths, one of which is the Monarch (Danaus plexippus), the fifth most recorded species in the country. That’s awesome!\nUnfortunately, most of these species have only been recorded a few times in specific locations, and we lack further information about them. You can help! Next time you’re outside, whether on a hike or doing fieldwork, take a photo of any butterflies or moths you see and upload it to iNaturalist.\nOr if you’re interested in contributing checklist data and recording your observations in a more structured way, check out eButterfly"
  },
  {
    "objectID": "challenges/challenge-Butterfly.html#whats-the-problem",
    "href": "challenges/challenge-Butterfly.html#whats-the-problem",
    "title": "More than the Monarch",
    "section": "",
    "text": "In Canada, we have more than 5,000 species recorded of butterflies and moths, one of which is the Monarch (Danaus plexippus), the fifth most recorded species in the country. That’s awesome!\nUnfortunately, most of these species have only been recorded a few times in specific locations, and we lack further information about them. You can help! Next time you’re outside, whether on a hike or doing fieldwork, take a photo of any butterflies or moths you see and upload it to iNaturalist.\nOr if you’re interested in contributing checklist data and recording your observations in a more structured way, check out eButterfly"
  },
  {
    "objectID": "challenges/challenge-Butterfly.html#where-should-you-go",
    "href": "challenges/challenge-Butterfly.html#where-should-you-go",
    "title": "More than the Monarch",
    "section": "Where should you go?",
    "text": "Where should you go?\nAll Canada!\nWhenever you’re doing an outdoor activity, look for butterflies and moths, take a picture and upload it in the iNaturalist app. Every observation counts."
  },
  {
    "objectID": "challenges/challenge-Butterfly.html#not-sure-what-to-look-for",
    "href": "challenges/challenge-Butterfly.html#not-sure-what-to-look-for",
    "title": "More than the Monarch",
    "section": "Not sure what to look for?",
    "text": "Not sure what to look for?\nCheck out this interesting species!"
  },
  {
    "objectID": "challenges/challenge-Butterfly.html#made-in-canada",
    "href": "challenges/challenge-Butterfly.html#made-in-canada",
    "title": "More than the Monarch",
    "section": "Made in Canada",
    "text": "Made in Canada\nWe have endemic butterfly and moth species here in Canada. On this map, you can see the ones that have been recorded. Help us gather more information about them\n{=html, echo = TRUE, eval = TRUE} &lt;iframe width=\"900\" height=\"700\" src=\"maps/challenge_MadeCanada_Butterfly_map.html\" title=\"Endemic butterflies and moths species\"&gt;&lt;/iframe&gt;\nSadly, some endemic species haven’t been recorded yet. Help us find them, take a photo and upload it!\n\n\n\nSpecies\nCommon Name\nGroup\n\n\n\n\nAnimomyia hardwicki\nGeometrid moth\nMoths\n\n\nElachista cicadella\nGlass miner moth\nMoths\n\n\nElachista serra\nGlass miner moth\nMoths\n\n\nEuxoa apopsis\nDart moth\nMoths\n\n\nEuxoa muldersi\nMulder’s Dart Moth\nMoths\n\n\nFeltia troubridgei\nNoctuid moth\nMoths\n\n\nHydrelia terraenovae\nCarpet moth\nMoths\n\n\nLasionycta gelida\nNoctuid moth\nMoths\n\n\nPelochrista louisana\nTortricid moth\nMoths\n\n\nStenoptilia grandipuncta\nPlume moth\nMoths"
  },
  {
    "objectID": "challenges/challenge-Butterfly.html#canada-most-wanted",
    "href": "challenges/challenge-Butterfly.html#canada-most-wanted",
    "title": "More than the Monarch",
    "section": "Canada most wanted",
    "text": "Canada most wanted\nHave you seen this butterfly?\nHelp find these missing Canadian species\n{=html, echo = TRUE, eval = TRUE} &lt;iframe width=\"900\" height=\"700\" src=\"maps/challenge_wanted_butterfly_map.html\" title=\"Most wanted butterflies and moths\"&gt;&lt;/iframe&gt;"
  },
  {
    "objectID": "challenges/challenge-Butterfly.html#who-created-this-challenge",
    "href": "challenges/challenge-Butterfly.html#who-created-this-challenge",
    "title": "More than the Monarch",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was created for Blitz the Gap, designed by Camila Diaz. [Some information about yourselves and how you use iNaturalist, or use their data in your own research, etc.]"
  },
  {
    "objectID": "challenges/Seaweeds_challenge.html#whats-the-problem",
    "href": "challenges/Seaweeds_challenge.html#whats-the-problem",
    "title": "Seaweeds of Canada",
    "section": "What’s the problem?",
    "text": "What’s the problem?\nAhoy! Beachcombers, beachgoers, and beach bums rejoice! Have we got a challenge for you!\nWhen you’re admiring the crazy things you find by the sea why not contribute to biodiversity data and learn about the seaweeds you find along the way. All you need to do is take photos of the seaweeds you find and upload them to iNaturalist to learn all about their crazy forms, functions, and life history.\nJoin the iNaturalist project!"
  },
  {
    "objectID": "challenges/Seaweeds_challenge.html#tips-and-tricks",
    "href": "challenges/Seaweeds_challenge.html#tips-and-tricks",
    "title": "Seaweeds of Canada",
    "section": "Tips and Tricks",
    "text": "Tips and Tricks\nTry to get the best photos you can of as many structures as you can. There are seaweed identification resources like books (e.g. Pacific Seaweeds: A Guide to Common Seaweeds of the West Coast), apps (e.g. https://seaweedsorter.com/), and websites (e.g. https://www.centralcoastbiodiversity.org/seaweeds-algae-and-seagrasses.html) that have a ton of great information about what to look for and what you should try to take pictures of… apart from that, the iNaturalist Computer Vision (AI) is getting better and better so check those recommendations as well."
  },
  {
    "objectID": "challenges/Seaweeds_challenge.html#best-finds",
    "href": "challenges/Seaweeds_challenge.html#best-finds",
    "title": "Seaweeds of Canada",
    "section": "Best Finds",
    "text": "Best Finds\nWe all love Bull Kelp and Knotted Wrack but we hope you’ll also love observing some of the other underreported species you can find in coastal Canadian waters. Here are some neat finds to start you on your seaweed safari treasure hunt:\n\nDead Man’s Fingers (Codium fragile)\nThe Five Ribbed Kelp (Costaria costata)\nSea Cauliflower (Leathesia marina)\nThe Winged Kelp (Alaria marginata) *bonus points if your specimen has ‘wings’ at the base (sporophylls)\nMermaid’s Tresses (Chorda filum)\nRed Eyelet Silk (Sparlingia pertusa)\nMazzaella japonica which is an invasive species in British Columbia"
  },
  {
    "objectID": "challenges/Seaweeds_challenge.html#title-for-your-map",
    "href": "challenges/Seaweeds_challenge.html#title-for-your-map",
    "title": "Seaweeds of Canada",
    "section": "Title for your map",
    "text": "Title for your map\nWe’ll insert your html widget map here, like this:"
  },
  {
    "objectID": "challenges/Seaweeds_challenge.html#who-created-this-challenge",
    "href": "challenges/Seaweeds_challenge.html#who-created-this-challenge",
    "title": "Seaweeds of Canada",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was made during the Blitz the Gap working group supported by the Canadian Institute of Ecology and Evolution’s Living Data Project (CIEE LDP). The working group is led by Laura Pollock, Diane Srivastava, Katherine Hébert, David Hunt, Sandra Emry from McGill University and University of British Columbia. This challenge was made by:\n- Sandra Emry is a Postdoctoral Fellow at the University of British Columbia and the Living Data Project. @sea_hugger\n- Nathan Earley is a PhD student at the University of Victoria where he studies species occurrence data and underreported species. @earley_bird\n- Bridgette Clarkston is an Associate Professor of Teaching at the University of British Columbia and the author of Pacific Seaweeds: A Guide to Common Seaweeds of the West Coast. @bclarkston"
  },
  {
    "objectID": "challenges/challenge_canadas_most_wanted.html",
    "href": "challenges/challenge_canadas_most_wanted.html",
    "title": "Canada’s Most Wanted",
    "section": "",
    "text": "1 in 5 species in Canada are at some level of risk of extinction. Over 2,200 species are currently threatened nationally or within individual provinces and territories.\nAt the same time, Invasive species cost the Canadian economy over $34 billion each year in damages and management. They outcompete native species, destroy habitats, and often go unnoticed until it’s too late. We have gathered a list of the most critically endangered native species, and the invasive species with the worst impact - CANADA’S MOST WANTED, and we need your help to get them!"
  },
  {
    "objectID": "challenges/challenge_canadas_most_wanted.html#whats-the-problem",
    "href": "challenges/challenge_canadas_most_wanted.html#whats-the-problem",
    "title": "Canada’s Most Wanted",
    "section": "",
    "text": "1 in 5 species in Canada are at some level of risk of extinction. Over 2,200 species are currently threatened nationally or within individual provinces and territories.\nAt the same time, Invasive species cost the Canadian economy over $34 billion each year in damages and management. They outcompete native species, destroy habitats, and often go unnoticed until it’s too late. We have gathered a list of the most critically endangered native species, and the invasive species with the worst impact - CANADA’S MOST WANTED, and we need your help to get them!"
  },
  {
    "objectID": "challenges/challenge_canadas_most_wanted.html#where-should-you-go",
    "href": "challenges/challenge_canadas_most_wanted.html#where-should-you-go",
    "title": "Canada’s Most Wanted",
    "section": "Where should you go?",
    "text": "Where should you go?\nAnywhere in Canada! Whether you’re: Hiking in a park Walking your dog Fishing by the lake Walking to work or school Going on a road trip\nYou Don’t Need to Be a Scientist. Just Be Curious. Photograph plants and animals anywhere in Canada. All it takes is your phone, a bit of time outdoors, and an eye for plants and animals. Your photo uploads make a real difference."
  },
  {
    "objectID": "challenges/challenge_canadas_most_wanted.html#too-hot-to-handle-map-of-highest-warming-and-undersampled",
    "href": "challenges/challenge_canadas_most_wanted.html#too-hot-to-handle-map-of-highest-warming-and-undersampled",
    "title": "Canada’s Most Wanted",
    "section": "Too hot to handle: Map of highest warming and undersampled",
    "text": "Too hot to handle: Map of highest warming and undersampled\n{=html, echo = TRUE, eval = FALSE} &lt;iframe width=\"900\" height=\"700\" src=\"01_outdata/maps/whole_map_canada\" title=\"Canada’s Most Wanted\"&gt;&lt;/iframe&gt;"
  },
  {
    "objectID": "challenges/challenge_canadas_most_wanted.html#what-species-should-you-look-for",
    "href": "challenges/challenge_canadas_most_wanted.html#what-species-should-you-look-for",
    "title": "Canada’s Most Wanted",
    "section": "What species should you look for?",
    "text": "What species should you look for?\nUpload every and any species you find! If they are endangered or invasive, this project will capture them automatically, you don’t need to figure that out yourself! FYI, here are the species in each category with the fewest observations:\nMOST WANTED RARE SPECIES Atlantic Whitefish, Lake Sturgeon, Vancouver Island Marmot, North Pacific Right Whale, Western Prairie Fringed Orchid, Little Brown Bat, Beluga Whale, Johnson’s Hairstreak, White Sturgeon, Peary Caribou, and Wolverine.\nMOST WANTED INVASIVE SPECIES Asian Long-horned Beetle, Striped Cucumber Beetle, Giant African Snail,Summer Fruit Tortrix, Jointed Goatgrass"
  },
  {
    "objectID": "challenges/challenge_canadas_most_wanted.html#who-created-this-challenge",
    "href": "challenges/challenge_canadas_most_wanted.html#who-created-this-challenge",
    "title": "Canada’s Most Wanted",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was created for Blitz the Gap, designed by Eniola Olu-Ayorinde, Sarfaroz Yunusov, Nathan Earley, and John Reynolds."
  },
  {
    "objectID": "challenges/challenge2_mayBAs.html",
    "href": "challenges/challenge2_mayBAs.html",
    "title": "Conservation Priorities in Canada (MayBAs)",
    "section": "",
    "text": "image from Birds Canada\n\n\n“30 by 30” is an initiative by 120 countries worldwide, including Canada, to protect 30% of land, inland waters, and sea by 2030. Canada plays a big role in reaching this goal thanks to our huge land area and its biodiversity. But the lands are not chosen randomly, they are chosen to maximize their impact on preserving biodiversity. Making those choices means we need data, and this is where citizen scientists like you can help. By getting out and observing what species are present in potential key areas that are currently underdocumented, you can make a real difference in the 30 by 30 initiative. Citizen scientist observations of key species could be the data we need to inform the public and governments about which areas need to be preserved.\nJoin the iNaturalist project!"
  },
  {
    "objectID": "challenges/challenge2_mayBAs.html#how-can-you-help-to-conserve-and-protect-canadas-biodiversity",
    "href": "challenges/challenge2_mayBAs.html#how-can-you-help-to-conserve-and-protect-canadas-biodiversity",
    "title": "Conservation Priorities in Canada (MayBAs)",
    "section": "",
    "text": "image from Birds Canada\n\n\n“30 by 30” is an initiative by 120 countries worldwide, including Canada, to protect 30% of land, inland waters, and sea by 2030. Canada plays a big role in reaching this goal thanks to our huge land area and its biodiversity. But the lands are not chosen randomly, they are chosen to maximize their impact on preserving biodiversity. Making those choices means we need data, and this is where citizen scientists like you can help. By getting out and observing what species are present in potential key areas that are currently underdocumented, you can make a real difference in the 30 by 30 initiative. Citizen scientist observations of key species could be the data we need to inform the public and governments about which areas need to be preserved.\nJoin the iNaturalist project!"
  },
  {
    "objectID": "challenges/challenge2_mayBAs.html#key-biodiversity-areas",
    "href": "challenges/challenge2_mayBAs.html#key-biodiversity-areas",
    "title": "Conservation Priorities in Canada (MayBAs)",
    "section": "Key Biodiversity Areas",
    "text": "Key Biodiversity Areas\nKey Biodiversity Areas (KBAs) are sites that contribute disproportionately to the persistence of biodiversity. If these sites are lost or degraded, species or ecosystems could disappear from Canada or the planet. KBAs are a building block for biodiversity conservation in Canada. They are used for: planning protected areas and other effective area-based conservation measures, land use planning, stewardship, restoration, Indigenous-led conservation, biodiversity monitoring, education and inspiration. KBAs are also summarised as an indicator of progress towards federal conservation commitments (such as the Kunming-Montreal Global Biodiversity Framework).\n“MayBAs” are areas which computer models or historical data have identified as areas where we need more data to make an informed decision on them becoming a KBA. We have included a map of these areas so citizen scientists like yourself can help build a pool of observations of priority species from a variety of groups and directly contribute to the decision process within Canada for what areas get protected."
  },
  {
    "objectID": "challenges/challenge2_mayBAs.html#where-should-you-go",
    "href": "challenges/challenge2_mayBAs.html#where-should-you-go",
    "title": "Conservation Priorities in Canada (MayBAs)",
    "section": "Where should you go?",
    "text": "Where should you go?\nTo bridge this gap, we encourage you to revisit sites that could become KBAs, but we need more data to be sure:\n\n\n\n\n\n\n\nWarning\n\n\n\nThe locations on this map are suggestions and not exact coordinates of where to sample. We cannot determine safety, ownership, or access to these lands. Please verify that you can legally and safely access these sites."
  },
  {
    "objectID": "challenges/challenge2_mayBAs.html#what-species-should-you-look-for",
    "href": "challenges/challenge2_mayBAs.html#what-species-should-you-look-for",
    "title": "Conservation Priorities in Canada (MayBAs)",
    "section": "What species should you look for?",
    "text": "What species should you look for?\nAny species in these places are important to look for! The KBA team has a list of species they need more data about to inform conservation. If you find one of these species, your observation will be logged in this iNaturalist project. Keep an eye out for them!"
  },
  {
    "objectID": "challenges/challenge2_mayBAs.html#who-made-this-challenge",
    "href": "challenges/challenge2_mayBAs.html#who-made-this-challenge",
    "title": "Conservation Priorities in Canada (MayBAs)",
    "section": "Who made this challenge?",
    "text": "Who made this challenge?\nThis challenge was made by the Canadian Institute of Ecology and Evolution’s Living Data Project in collaboration with the Wildlife Conservation Society (WCS) as part of the “Blitz the Gap” working group.\nBlitz the Gap was conceived and led by Katherine Hebert and Laura Pollock of the Quantitative Biodiversity Lab at McGill University, and David Hunt from the Living Data Project. The working group involved MSc and PhD students from McGill University, Université de Montréal, and Université de Sherbrooke. The MayBA maps were provided by WCS Canada thanks to Peter Soroye, the KBA Assessment and Outreach Coordinator, and Ciara Raudsepp-Hearne, who leads the WCS Canada KBA team to identify and map KBAs in Canada."
  },
  {
    "objectID": "workflows/parquet-file.html",
    "href": "workflows/parquet-file.html",
    "title": "Using the iNaturalist Canada parquet file",
    "section": "",
    "text": "For this working group, iNaturalist Canada provided us their data as a parquet file. Parquet is an open source file format that compresses and encodes large datasets for more efficient data storage, and importantly, more efficient retrieval of informaiton within the dataset. This format makes data lighter to handle because it is column-oriented, rather than row-oriented like a CSV file (which quickly gets overwhelming when you have many rows!).\nThis little tutorial will show you how to open the parquet file if you would like to explore it yourself. As a reminder, we have already made density maps from this file, so you may not need to explore it (depending on the challenge you’d like to build)!\nFirst, load the R packages you will need to use to access the density map layers:\n\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(arrow)\nlibrary(dbplyr, warn.conflicts = FALSE)\nlibrary(duckdb)\nlibrary(terra)\nlibrary(mapview) # for interactive maps\n\n# set ggplot theme of choice\ntheme_set(ggpubr::theme_pubr())\n\n\n\nNext, we will open the parquet file using the package arrow:\n\ninat_pq &lt;- arrow::open_dataset(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/biodiversity-data/inat-canada/iNat_non_sensitive_data_Jan2025.parquet\")\n\nNote that this isn’t the same as loading iNaturalist Canada as a CSV in your R session. Here, we’re establishing a connection to the database so we can make queries for the data that we really want.\nTake a look at the columns that are available in the file. We’ll use these columns to query the data with dplyr later:\n\ninat_pq$schema\n\nSchema\nOBJECTID: int64\nid: int32\nobserved_on_string: string\nuser_login: string\nquality_grade: string\nlicense: string\nurl: string\ntag_list: string\ndescription: string\nnum_identification_agreements: int32\nnum_identification_disagreements: int32\ncaptive_cultivated: string\nlatitude: double\nlongitude: double\npositional_accuracy: int32\npublic_positional_accuracy: int32\ngeoprivacy: string\ntaxon_geoprivacy: string\ncoordinates_obscured: string\npositioning_method: string\npositioning_device: string\nplace_town_name: string\nplace_county_name: string\nplace_state_name: string\nplace_country_name: string\nplace_admin1_name: string\nplace_admin2_name: string\nspecies_guess: string\nscientific_name: string\ncommon_name: string\niconic_taxon_name: string\ngeometry: binary\n\nSee $metadata for additional Schema metadata\n\n\n\n\n\nNext, we’ll query the data we want, and we will finish the query with the collect() command to load the query’s result into this R session.\nHere, we’ll summarise the number of observations per species, per group using dplyr (but you can use other dplyr functions like filter() for example!)\n\nquery &lt;- inat_pq |&gt; \n  \n  # E.g. you could filter by species group:\n  # filter(iconic_taxon_name == \"Aves\") |&gt;\n  \n  # Summarise number of obs per species, per species group\n  group_by(iconic_taxon_name, scientific_name) |&gt;\n  summarize(total_obs = n()) |&gt; \n  \n  # load the query into our R session\n  collect()\n\nLet’s have a look at the distribution of the number of observations per species, per group. We’ll put a vertical line to show the 100 observations/species mark, which we’ll dive into soon.\n\nggplot(data = query) +\n  geom_density(aes(x = total_obs,\n                     fill = iconic_taxon_name),\n               alpha = .5, lwd = .1) +\n  geom_vline(xintercept = 100) +\n  scale_x_log10() +\n  labs(x = \"Number of observations per species\",\n       y = \"Density (of species)\",\n       fill = \"Species group\") +\n  theme(legend.position = \"right\")\n\n\n\n\n\n\n\n\nLet’s summarise our initial query to the species group level, to see which groups have more samples:\n\nsummary_query = query |&gt;\n  group_by(iconic_taxon_name) |&gt;\n  summarise(total_obs = sum(total_obs),\n            median_obs = median(total_obs))\n\nThis is just a few lines of code to reorder the species group names according to the number of observations, for prettier plots:\n\nquery$iconic_taxon_name = factor(query$iconic_taxon_name,\n                                 levels = summary_query$iconic_taxon_name[order(summary_query$median_obs)])\nsummary_query$iconic_taxon_name = factor(summary_query$iconic_taxon_name,\n                                         levels = summary_query$iconic_taxon_name[order(summary_query$total_obs)])\n\nWhich groups have more total samples?\n\nggplot(data = summary_query) +\n  geom_bar(aes(y = iconic_taxon_name,\n               x = total_obs,\n               fill = iconic_taxon_name),\n           stat = \"identity\") +\n  theme(legend.position = \"none\") +\n  scale_x_log10()\n\n\n\n\n\n\n\n\n\n\n\nSpecies with under 100 observations are of special interest to iNaturalist, so let’s have a look at which species have fewer than 100 observations.\nFirst, let’s filter our initial query to only retain species with &lt; 100 observations. Here, I removed species with &lt; 5 observations to get rid of some species with mistakes in their names, or that were just higher-level classes, etc. (But you can remove this condition too to make sure you’ve got everything).\n\nquery_under100 = query |&gt;\n  filter(total_obs &lt; 100 & total_obs &gt; 5)\n\nHow many species in each group have fewer than 100 observations?\n\nquery_under100 |&gt; \n  group_by(iconic_taxon_name) |&gt; \n  summarise(nsp = n_distinct(scientific_name)) \n\n# A tibble: 14 × 2\n   iconic_taxon_name   nsp\n   &lt;fct&gt;             &lt;int&gt;\n 1 Protozoa            159\n 2 Chromista           240\n 3 Actinopterygii      350\n 4 Reptilia             68\n 5 Mollusca            577\n 6 Amphibia             37\n 7 Animalia           1246\n 8 Arachnida           559\n 9 Mammalia            284\n10 Fungi              3045\n11 Aves                577\n12 Insecta            9484\n13 Plantae            5781\n14 &lt;NA&gt;                 91\n\n\nLet’s have a look at the number of observations per species for these under-sampled species.\n\nggplot(data = query_under100) +\n  geom_histogram(aes(x = total_obs, \n                          fill = iconic_taxon_name),\n                 bins = 10) +\n  theme(legend.position = \"none\") +\n  facet_wrap(~iconic_taxon_name, ncol = 2) +\n  labs(x = \"Number of observations per species\", \n       y = \"Number of species\") \n\n\n\n\n\n\n\n\nWe can see that for groups like fungi, insects and plants, there are many species with less than 30 observations!\n\n\n\nLet’s make the iNaturalist query into a spatial object. First, we’ll make a vector layer, which we’ll then transform into a raster layer.\nFor the example, we’ll only do this for plants:\n\nobs &lt;- inat_pq |&gt;\n  # filter to plant species with &lt; 100 observations:\n  filter(scientific_name %in% query_under100$scientific_name,\n         iconic_taxon_name %in% \"Plantae\") |&gt;\n  # select columns we want to keep\n  select(c(longitude, latitude, \n           iconic_taxon_name, \n           scientific_name, \n           coordinates_obscured)) |&gt;\n  collect()\n\nNext, we need the polygon of Canada and a base grid that we’ll use to make our raster.\n\n# Load Canada polygon\ncanada = sf::read_sf(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/canada-polygon/canada.outline.shp\")\n\n# Read in base grid layer to make the raster\nbase.50k = terra::rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/canada.base.5k.tiff\") |&gt;\n  # convert to a coarser resolution for this example\n  terra::aggregate(fact = 10)\n\nNext, we convert the iNaturalist data to a vector layer and make sure to project it and to crop out any points that are not within Canada (just in case):\n\n# convert the iNaturalist ob\ninat.v = terra::vect(obs, geom = c(\"longitude\",\"latitude\"),\n             crs=\"+proj=longlat +ellps=WGS84\")\n# project to match the base grid\ninat.v = terra::project(inat.v, crs(base.50k))\n# crop observations outside of Canada\ninat.v = terra::crop(inat.v, canada)\n\nNow we can convert this vector into a raster of the density of observations of plant species that have &lt; 100 observations in Canada:\n\n# make iNat density layer\nrareplant.density = rasterize(inat.v, base.50k, fun = \"length\")\n\n# plot it!\npal = viridis::turbo(5)\nmapview(rareplant.density, \n        col.regions = pal,\n        layer.name = \"Density\", \n        na.color = \"transparent\")"
  },
  {
    "objectID": "workflows/parquet-file.html#open-the-parquet-file",
    "href": "workflows/parquet-file.html#open-the-parquet-file",
    "title": "Using the iNaturalist Canada parquet file",
    "section": "",
    "text": "Next, we will open the parquet file using the package arrow:\n\ninat_pq &lt;- arrow::open_dataset(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/biodiversity-data/inat-canada/iNat_non_sensitive_data_Jan2025.parquet\")\n\nNote that this isn’t the same as loading iNaturalist Canada as a CSV in your R session. Here, we’re establishing a connection to the database so we can make queries for the data that we really want.\nTake a look at the columns that are available in the file. We’ll use these columns to query the data with dplyr later:\n\ninat_pq$schema\n\nSchema\nOBJECTID: int64\nid: int32\nobserved_on_string: string\nuser_login: string\nquality_grade: string\nlicense: string\nurl: string\ntag_list: string\ndescription: string\nnum_identification_agreements: int32\nnum_identification_disagreements: int32\ncaptive_cultivated: string\nlatitude: double\nlongitude: double\npositional_accuracy: int32\npublic_positional_accuracy: int32\ngeoprivacy: string\ntaxon_geoprivacy: string\ncoordinates_obscured: string\npositioning_method: string\npositioning_device: string\nplace_town_name: string\nplace_county_name: string\nplace_state_name: string\nplace_country_name: string\nplace_admin1_name: string\nplace_admin2_name: string\nspecies_guess: string\nscientific_name: string\ncommon_name: string\niconic_taxon_name: string\ngeometry: binary\n\nSee $metadata for additional Schema metadata"
  },
  {
    "objectID": "workflows/parquet-file.html#query-the-data",
    "href": "workflows/parquet-file.html#query-the-data",
    "title": "Using the iNaturalist Canada parquet file",
    "section": "",
    "text": "Next, we’ll query the data we want, and we will finish the query with the collect() command to load the query’s result into this R session.\nHere, we’ll summarise the number of observations per species, per group using dplyr (but you can use other dplyr functions like filter() for example!)\n\nquery &lt;- inat_pq |&gt; \n  \n  # E.g. you could filter by species group:\n  # filter(iconic_taxon_name == \"Aves\") |&gt;\n  \n  # Summarise number of obs per species, per species group\n  group_by(iconic_taxon_name, scientific_name) |&gt;\n  summarize(total_obs = n()) |&gt; \n  \n  # load the query into our R session\n  collect()\n\nLet’s have a look at the distribution of the number of observations per species, per group. We’ll put a vertical line to show the 100 observations/species mark, which we’ll dive into soon.\n\nggplot(data = query) +\n  geom_density(aes(x = total_obs,\n                     fill = iconic_taxon_name),\n               alpha = .5, lwd = .1) +\n  geom_vline(xintercept = 100) +\n  scale_x_log10() +\n  labs(x = \"Number of observations per species\",\n       y = \"Density (of species)\",\n       fill = \"Species group\") +\n  theme(legend.position = \"right\")\n\n\n\n\n\n\n\n\nLet’s summarise our initial query to the species group level, to see which groups have more samples:\n\nsummary_query = query |&gt;\n  group_by(iconic_taxon_name) |&gt;\n  summarise(total_obs = sum(total_obs),\n            median_obs = median(total_obs))\n\nThis is just a few lines of code to reorder the species group names according to the number of observations, for prettier plots:\n\nquery$iconic_taxon_name = factor(query$iconic_taxon_name,\n                                 levels = summary_query$iconic_taxon_name[order(summary_query$median_obs)])\nsummary_query$iconic_taxon_name = factor(summary_query$iconic_taxon_name,\n                                         levels = summary_query$iconic_taxon_name[order(summary_query$total_obs)])\n\nWhich groups have more total samples?\n\nggplot(data = summary_query) +\n  geom_bar(aes(y = iconic_taxon_name,\n               x = total_obs,\n               fill = iconic_taxon_name),\n           stat = \"identity\") +\n  theme(legend.position = \"none\") +\n  scale_x_log10()"
  },
  {
    "objectID": "workflows/parquet-file.html#which-species-have-100-observations",
    "href": "workflows/parquet-file.html#which-species-have-100-observations",
    "title": "Using the iNaturalist Canada parquet file",
    "section": "",
    "text": "Species with under 100 observations are of special interest to iNaturalist, so let’s have a look at which species have fewer than 100 observations.\nFirst, let’s filter our initial query to only retain species with &lt; 100 observations. Here, I removed species with &lt; 5 observations to get rid of some species with mistakes in their names, or that were just higher-level classes, etc. (But you can remove this condition too to make sure you’ve got everything).\n\nquery_under100 = query |&gt;\n  filter(total_obs &lt; 100 & total_obs &gt; 5)\n\nHow many species in each group have fewer than 100 observations?\n\nquery_under100 |&gt; \n  group_by(iconic_taxon_name) |&gt; \n  summarise(nsp = n_distinct(scientific_name)) \n\n# A tibble: 14 × 2\n   iconic_taxon_name   nsp\n   &lt;fct&gt;             &lt;int&gt;\n 1 Protozoa            159\n 2 Chromista           240\n 3 Actinopterygii      350\n 4 Reptilia             68\n 5 Mollusca            577\n 6 Amphibia             37\n 7 Animalia           1246\n 8 Arachnida           559\n 9 Mammalia            284\n10 Fungi              3045\n11 Aves                577\n12 Insecta            9484\n13 Plantae            5781\n14 &lt;NA&gt;                 91\n\n\nLet’s have a look at the number of observations per species for these under-sampled species.\n\nggplot(data = query_under100) +\n  geom_histogram(aes(x = total_obs, \n                          fill = iconic_taxon_name),\n                 bins = 10) +\n  theme(legend.position = \"none\") +\n  facet_wrap(~iconic_taxon_name, ncol = 2) +\n  labs(x = \"Number of observations per species\", \n       y = \"Number of species\") \n\n\n\n\n\n\n\n\nWe can see that for groups like fungi, insects and plants, there are many species with less than 30 observations!"
  },
  {
    "objectID": "workflows/parquet-file.html#convert-the-parquet-query-into-a-vector-and-a-raster-layer",
    "href": "workflows/parquet-file.html#convert-the-parquet-query-into-a-vector-and-a-raster-layer",
    "title": "Using the iNaturalist Canada parquet file",
    "section": "",
    "text": "Let’s make the iNaturalist query into a spatial object. First, we’ll make a vector layer, which we’ll then transform into a raster layer.\nFor the example, we’ll only do this for plants:\n\nobs &lt;- inat_pq |&gt;\n  # filter to plant species with &lt; 100 observations:\n  filter(scientific_name %in% query_under100$scientific_name,\n         iconic_taxon_name %in% \"Plantae\") |&gt;\n  # select columns we want to keep\n  select(c(longitude, latitude, \n           iconic_taxon_name, \n           scientific_name, \n           coordinates_obscured)) |&gt;\n  collect()\n\nNext, we need the polygon of Canada and a base grid that we’ll use to make our raster.\n\n# Load Canada polygon\ncanada = sf::read_sf(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/canada-polygon/canada.outline.shp\")\n\n# Read in base grid layer to make the raster\nbase.50k = terra::rast(\"~/McGill University/Laura's Lab_Group - BioBlitz/data/raw/base-layers/canada.base.5k.tiff\") |&gt;\n  # convert to a coarser resolution for this example\n  terra::aggregate(fact = 10)\n\nNext, we convert the iNaturalist data to a vector layer and make sure to project it and to crop out any points that are not within Canada (just in case):\n\n# convert the iNaturalist ob\ninat.v = terra::vect(obs, geom = c(\"longitude\",\"latitude\"),\n             crs=\"+proj=longlat +ellps=WGS84\")\n# project to match the base grid\ninat.v = terra::project(inat.v, crs(base.50k))\n# crop observations outside of Canada\ninat.v = terra::crop(inat.v, canada)\n\nNow we can convert this vector into a raster of the density of observations of plant species that have &lt; 100 observations in Canada:\n\n# make iNat density layer\nrareplant.density = rasterize(inat.v, base.50k, fun = \"length\")\n\n# plot it!\npal = viridis::turbo(5)\nmapview(rareplant.density, \n        col.regions = pal,\n        layer.name = \"Density\", \n        na.color = \"transparent\")"
  },
  {
    "objectID": "workflows/access-data.html",
    "href": "workflows/access-data.html",
    "title": "Accessing the STAC Catalogue",
    "section": "",
    "text": "From Bon in a Box’s “Working with STAC” documentation, which you can see here:\n\nSTAC stands for SpatioTemporal Asset Catalog. It is a common language to describe geospatial information, so it can be more easily worked with, indexed, and discovered. Spatial information is stored in a geoJSON format, which can be easily adapted to different domains. The goal of STAC is to enable a global index of all imagery derived data products with an easily implementable standard for organization to expose their data in a persistent and reliable way. STAC objects are hosted in geoJSON format as HTML pages."
  },
  {
    "objectID": "workflows/access-data.html#inaturalist-density-maps",
    "href": "workflows/access-data.html#inaturalist-density-maps",
    "title": "Accessing the STAC Catalogue",
    "section": "iNaturalist density maps",
    "text": "iNaturalist density maps\nA series of density maps of iNaturalist observations is hosted on the Biodiversité Québec STAC. This means you can access density maps and work with them as a proxy, or download it locally to use as the basis for a Blitz the Gap challenge. There are two resolutions available for each taxonomic group: 100m, and 1km.\nFirst, load the R packages you will need to use to access the density map layers:\n\nlibrary(gdalcubes)\nlibrary(rstac)\nlibrary(knitr)\nlibrary(stars)\nlibrary(terra)\nlibrary(ggplot2)\nlibrary(mapview)\n\nSet up the connection to the STAC catalog:\n\n# set up\nstac_obj &lt;- stac(\"https://io.biodiversite-quebec.ca/stac/\")\n\n# get iNaturalist heatmaps for Canada\nit_obj &lt;- stac_obj |&gt;\n  stac_search(collections = \"inat_canada_heatmaps\") |&gt;\n  post_request() |&gt; items_fetch()\nit_obj\n\nGet a table showing which layers are available in the catalog:\n\n# See layers in the object\ndf &lt;- data.frame(description=character())\nfor (f in it_obj[['features']]){\n  df &lt;- rbind(df,data.frame(description=f$properties$description)) \n}\ndf$feature_number = 1:nrow(df)\n\n\n\n\n\n\n\ndescription\nfeature_number\n\n\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Reptilia at 1km resolution\n1\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Reptilia at 100m resolution\n2\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Protozoa at 1km resolution\n3\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Protozoa at 100m resolution\n4\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Plantae at 1km resolution\n5\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Plantae at 100m resolution\n6\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Mollusca at 1km resolution\n7\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Mollusca at 100m resolution\n8\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Mammalia at 1km resolution\n9\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Mammalia at 100m resolution\n10\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Insecta at 1km resolution\n11\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Insecta at 100m resolution\n12\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Fungi at 1km resolution\n13\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Fungi at 100m resolution\n14\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Chromista at 1km resolution\n15\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Chromista at 100m resolution\n16\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Aves at 1km resolution\n17\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Aves at 100m resolution\n18\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Arachnida at 1km resolution\n19\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Arachnida at 100m resolution\n20\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Animalia at 1km resolution\n21\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Animalia at 100m resolution\n22\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Amphibia at 1km resolution\n23\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Amphibia at 100m resolution\n24\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group All at 1km resolution\n25\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group All at 100m resolution\n26\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Actinopterygii at 1km resolution\n27\n\n\nDensity of observations in iNaturalist Canada for species of taxonomic group Actinopterygii at 100m resolution\n28\n\n\n\n\n\n\n\n\ndf\n\nLet’s access one of the layers to map it, as an example. We’ll map the density of iNaturalist observations across all taxa by selecting one of the features we listed in the table above.\nHow do we select one of the layers in the STAC Catalog? You can index them by checking the feature_number column above.\nHere, we want “Density of observations in iNaturalist Canada for species of taxonomic group All at 1km resolution”, which is the 25th layer:\n\n# 37 is the number to change if you want another layer from the STAC\ninat &lt;- read_stars(paste0('/vsicurl/', it_obj[['features']][[25]]$assets[[1]]$href), \n                   proxy = TRUE) # using it as a proxy (not a local download,\n                                 # to save time and space!)\n\nNow, let’s map it!\nFirst, load a polygon of Canada that you can download from the data/raw folder on the Sharepoint (or the 00_rawdata folder on the GitHub repository). Make sure to update the file path to match the folder in which you placed the file when you downloaded it!\n\n# read the Canada polygon\ncanada = sf::read_sf(\"data/raw/base-layers/canada-polygon/canada.outline.shp\")\n\nPrepare the data for plotting, and use ggplot2 to map it!\n\n# crop the raster to canada (to cut off the ocean, USA, etc.)\ninat = sf::st_crop(inat, canada)\n\n# (optional) transform data for easier plotting\n# this will square root each raster cell's value. this could also be log10, etc.\ninat_sqrt = inat |&gt; sqrt()\n\n# map!\nggplot() +\n  geom_stars(data = inat_sqrt, \n             # plotting at a coarser resolution to make this faster\n             downsample = 10, \n             na.action = na.omit) +\n  scale_fill_viridis_c(option = \"turbo\", \n                       end = .5,\n                       na.value = \"transparent\") +\n  theme_void() +\n  theme(legend.position = \"top\") +\n  labs(fill = \"Density\") +\n  coord_equal() \n\n\n\n\n\n\n\n\nTo make an interactive map that we can zoom into, we can use the package mapview:\nFirst, let’s some mapview options to apply to all the maps we will make here:\n\nmapviewOptions(basemaps = c(\"OpenStreetMap\"),\n               na.color = \"transparent\")\n\nNow, here’s the map!\n\npal = viridis::turbo(5)\nmapview(inat_sqrt, \n        col.regions = pal, # assign color palette\n        layer.name = \"Density (sqrt)\") \n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 24627120 to avoid this."
  }
]