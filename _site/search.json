[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Blitz the Gap",
    "section": "",
    "text": "Blitz the Gap is a Canada-wide bioblitz to help us fill gaps in our knowledge of biodiversity in Canada. Canada is a large country and hosts tons of amazing biodiversity - which makes it a challenging place to survey. Though we’ve made progress thanks to community science platforms like iNat, we are still lacking the data for a whole host of ecological and conservation applications. We need more data to assess at-risk species, track the changes in species’ ranges due to climate change, rapidly detect species losses and invasions, and more."
  },
  {
    "objectID": "index.html#ready-set-blitz-the-gap",
    "href": "index.html#ready-set-blitz-the-gap",
    "title": "Blitz the Gap",
    "section": "Ready? Set? Blitz the Gap!",
    "text": "Ready? Set? Blitz the Gap!"
  },
  {
    "objectID": "tutorial.html",
    "href": "tutorial.html",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "This is an example workflow to identify gaps in a biodiversity database (like GBIF or iNaturalist), and to generate raster maps where each cell is assigned a priority level for sampling in a bioblitz event.\nEach map will cross biodiversity priorities with accessibility to identify the cells that are easiest to sample while helping to fill a biodiversity data gap. Gaps will be defined based on “Challenges” that will be part of the Blitz the Gap event.\nHere, we will build an example challenge to encourage community scientists to update historical records of amphibians.\n\n\nLoad packages:\n\nlibrary(dplyr) \nlibrary(terra)\nlibrary(rgbif)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(mapview)\nlibrary(raster)\n\nSet some mapview options to apply to all the maps we will make here:\n\nmapviewOptions(basemaps = c( \"OpenStreetMap\"),\n               na.color = \"transparent\")\n\n\n\nLoad spatial layers that we will use to make sure all of our layers match (in terms of the grid resolution and projection).\n\n# Canada polygon\ncanada = sf::read_sf(\"data/raw/base-layers/canada-polygon/canada.outline.shp\")\n\n# Base grid for rasterizing\nbase.5k = terra::rast(\"data/raw/base-layers/canada.base.5k.tiff\")\n\n# Mask water and built areas\nbase.water &lt;- rast(\"data/raw/base-layers/WaterUrbanBuiltMask.tif\")\nbase.water&lt;-project(base.water,crs(base.5k))\nbase.water&lt;-resample(base.water,base.5k,method='near')\nterra::writeRaster(base.water, \"data/processed/base-layers/WaterUrbanBuiltMask.tif\")\n\n# Make a reverse of the base layer to remove cells that we don't want to consider (later)\nanti.base=base.5k\nanti.base[is.na(anti.base)] &lt;- 1\nanti.base[anti.base==2] &lt;- NA\nanti.base[base.water==1] &lt;- 1\nterra::writeRaster(anti.base, \"data/processed/base-layers/anti.base.5k.tif\")\n\n\n\n\nThis tutorial will use GBIF data, though later steps will be similarly useful to process iNaturalist data. Here, let’s use a download of all amphibian data in Canada.\n\n# Download the GBIF data through the GBIF data website. Make sure to save the citation details from the download in a text file alongside the data.\n# Unzip in the data/raw/gbif/your_taxa_of_choice folder\n# Read in the dataset and select columns we need\ngbif = data.table::fread(\"data/raw/gbif/amphibians/0007149-250127130748423.csv\") |&gt;\n  filter(coordinateUncertaintyInMeters &lt; 100000) |&gt;\n  select(family, scientificName, year,\n         decimalLongitude, decimalLatitude, coordinatePrecision,\n         datasetKey, basisOfRecord)\n\nFirst, we need to prepare the GBIF data into a spatial object:\n\n# Convert GBIF to a points layer\ngbif.v &lt;- vect(gbif,\n               geom=c(\"decimalLongitude\",\"decimalLatitude\"),\n             crs=\"+proj=longlat +ellps=WGS84\",\n             keepgeom = TRUE)\n\n# Project GBIF \ngbif.v &lt;- project(gbif.v, crs(base.5k))\n\n# Remove occurrences outside the canada polygon\ngbif.v = terra::crop(gbif.v, canada)\n\nNow we can convert the GBIF data into raster layers:\n\ngbif.density: count of GBIF observations per cell\nmuseum.density: count of GBIF observations from preserved specimens (museums) per cell\niNat.density: count of GBIF observations from iNaturalist (dataset key: \"50c9509d-22c7-4a22-a47d-8c48425ef4a7\") per cell\nyear.last.sampled: year of the last GBIF observation in GBIF per cell\n\n\n# Make a GBIF density layer\ngbif.density &lt;- rasterize(gbif.v, base.5k, fun=\"count\")\n\n# Density of museum observations\nmuseum.density &lt;- rasterize(gbif.v[which(gbif.v$basisOfRecord == \"PRESERVED_SPECIMEN\")], base.5k, fun=\"count\")\n\n# Density of observations from iNaturalist alone\niNat.density &lt;- rasterize(gbif.v[which(gbif.v$datasetKey == \"50c9509d-22c7-4a22-a47d-8c48425ef4a7\")], base.5k, fun=\"count\")\n\n# Raster of the latest observation's year\nyear.last.sampled &lt;- rasterize(gbif.v, base.5k, fun=\"max\", field=\"year\")\n\n# Stack the GBIF layers into one object for easy saving\ngbif.layers = c(gbif.density,museum.density,iNat.density,year.last.sampled)\nnames(gbif.layers) = c(\"gbif.density\",\"museum.density\",\"iNat.density\",\"year.last.sampled\")\ngbif.layers[is.na(base.5k)]&lt;-NA\n\n# save\nwriteRaster(gbif.layers,\"data/processed/gbif.layers.amphibians.tif\", overwrite = TRUE)\nwriteVector(gbif.v,\"data/processed/gbif.points.amphibians.shp\", overwrite = TRUE)\n\n\n\n\n\nMany of these layers are originally from the GEOBON STAC catalog, which can be viewed here: https://stac.geobon.org/viewer/. Instructions about how to retrieve these layers and download them for use are here: Working with STAC.\nThis is some code to reproject and resample the rasters from the STAC to match the GBIF density layers, after downloading them following the instructions linked above.\n\n\nClimate velocity (a metric of how quickly the climate will change by 2085 in each cell, under RCP85):\n\nvel &lt;- rast(\"data/raw/base-layers/climatevelocity_adaptwest_fwvel_ensemble_rcp85_2085.tif\")\nvel&lt;-project(vel,base.5k,\"bilinear\")\nvel&lt;-resample(vel,base.5k,method='near')\nvel[is.na(base.5k)] &lt;- NA\nterra::writeRaster(vel, \"data/processed/base-layers/climatevelocity_adaptwest_fwvel_ensemble_rcp85_2085.tif\")\n\n\n\n\nDistance to roads:\n\ndist.to.roads&lt;-rast(\"data/raw/base-layers/distance.to.roads.tif\")\ndist.to.roads&lt;-project(dist.to.roads,base.5k,\"bilinear\")\ndist.to.roads[is.na(base.5k)]&lt;-NA\nterra::writeRaster(dist.to.roads, \"data/processed/base-layers/dist.to.roads.tif\")\n\n\n\n\n\n\n\n\n# Copy the layer into a new object that we'll edit\nresamp &lt;- gbif.layers$year.last.sampled\nmapview(resamp, \n        na.color = \"transparent\")\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\nNext, we will assign priority values to cells based on the year they were last sampled. These are the priority levels we will use:\n\n\n\nPriority\nOldest observation\nNewest observation\n\n\n\n\nHigh (1)\noldest\n1950\n\n\nMedium (2)\n1951\n2000\n\n\nLow (3)\n2001\n2015\n\n\nNot a priority (4)\n2016\n2025\n\n\n\nLet’s assign these values based on the condition that the year last sampled in GBIF is within those year limits:\n\nresamp[gbif.layers$year.last.sampled &lt;= 1950] &lt;- 1\nresamp[gbif.layers$year.last.sampled &gt; 1950 & gbif.layers$year.last.sampled &lt;= 2000] &lt;- 2\nresamp[gbif.layers$year.last.sampled &gt; 2000 & gbif.layers$year.last.sampled &lt;= 2015] &lt;- 3\nresamp[gbif.layers$year.last.sampled &gt; 2015] &lt;- 4\n\nLet’s map this to see what we’re working with!\n\nmapview(resamp)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\n\n\n\nLet’s make a mask of the pixels we consider to be accessible. Let’s say anything within 10 km of a major road is potentially accessible, so we’re only interested in these cells:\n\nd10 = dist.to.roads\nd10[d10&gt;10000] &lt;- NA # assign NA to pixels that are over 10 km away from a major road\nmapview(d10)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\nNow, we can use this same condition (ignore anything where dist.to.roads &gt; 10000) to select cells from the priority layer that are accessible:\n\npal = viridis::viridis(n = 3, direction = -1)\npriority = resamp\npriority[dist.to.roads &gt; 10000] &lt;- NA\nmapview(priority, \n        col.regions = pal)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\n\n\n\nLet’s visualize this a little differently, so it is easier to explore. We will make a point layer with the year in which the cell was last sampled, and this layer is resized as we zoom in and out so it is easier to have a quick view of the map. When we zoom in, we will see the cell the point is referring to, so we make sure we’re still identifying the exact cell outline that we’d be asking people to go sample.\n\nlast.year = gbif.layers$year.last.sampled\nlast.year[priority &gt; 3] &lt;- NA\nlast.year[dist.to.roads &gt; 10000] &lt;- NA\n\nhistorical_pts = last.year |&gt;\n  raster::raster() |&gt;\n  raster::rasterToPoints(fun = function(x){x&lt;2016}, spatial = TRUE)\n\nhistorical_cells = priority |&gt;\n  raster::raster() |&gt;\n  raster::rasterToPolygons(fun = function(x){x &lt; 4})\n\npal = viridis::viridis(n = 3, direction = -1)\n(m = mapview(historical_cells, \n        legend = TRUE, \n        basemaps = \"OpenStreetMap\",  \n        col.regions = pal,\n        layer.name = \"Priority\") +\n  mapview(historical_pts,\n          col.regions = pal,\n          legend = FALSE, \n          layer.name = \"Year last \\nsampled\"))\n\nWarning: Found less unique colors (3) than unique zcol values (80)! \nInterpolating color vector to match number of zcol values.\n\n\n\n\n\n\n\nhtmlwidgets::saveWidget(m@map, \n                        file = \"challenges/maps/challenge1_map.html\", \n                        title = \"Revisit the past: Amphibians\")"
  },
  {
    "objectID": "tutorial.html#step-1.-prepare-gbif-data-and-make-density-layers",
    "href": "tutorial.html#step-1.-prepare-gbif-data-and-make-density-layers",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "Load packages:\n\nlibrary(dplyr) \nlibrary(terra)\nlibrary(rgbif)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(mapview)\nlibrary(raster)\n\nSet some mapview options to apply to all the maps we will make here:\n\nmapviewOptions(basemaps = c( \"OpenStreetMap\"),\n               na.color = \"transparent\")\n\n\n\nLoad spatial layers that we will use to make sure all of our layers match (in terms of the grid resolution and projection).\n\n# Canada polygon\ncanada = sf::read_sf(\"data/raw/base-layers/canada-polygon/canada.outline.shp\")\n\n# Base grid for rasterizing\nbase.5k = terra::rast(\"data/raw/base-layers/canada.base.5k.tiff\")\n\n# Mask water and built areas\nbase.water &lt;- rast(\"data/raw/base-layers/WaterUrbanBuiltMask.tif\")\nbase.water&lt;-project(base.water,crs(base.5k))\nbase.water&lt;-resample(base.water,base.5k,method='near')\nterra::writeRaster(base.water, \"data/processed/base-layers/WaterUrbanBuiltMask.tif\")\n\n# Make a reverse of the base layer to remove cells that we don't want to consider (later)\nanti.base=base.5k\nanti.base[is.na(anti.base)] &lt;- 1\nanti.base[anti.base==2] &lt;- NA\nanti.base[base.water==1] &lt;- 1\nterra::writeRaster(anti.base, \"data/processed/base-layers/anti.base.5k.tif\")\n\n\n\n\nThis tutorial will use GBIF data, though later steps will be similarly useful to process iNaturalist data. Here, let’s use a download of all amphibian data in Canada.\n\n# Download the GBIF data through the GBIF data website. Make sure to save the citation details from the download in a text file alongside the data.\n# Unzip in the data/raw/gbif/your_taxa_of_choice folder\n# Read in the dataset and select columns we need\ngbif = data.table::fread(\"data/raw/gbif/amphibians/0007149-250127130748423.csv\") |&gt;\n  filter(coordinateUncertaintyInMeters &lt; 100000) |&gt;\n  select(family, scientificName, year,\n         decimalLongitude, decimalLatitude, coordinatePrecision,\n         datasetKey, basisOfRecord)\n\nFirst, we need to prepare the GBIF data into a spatial object:\n\n# Convert GBIF to a points layer\ngbif.v &lt;- vect(gbif,\n               geom=c(\"decimalLongitude\",\"decimalLatitude\"),\n             crs=\"+proj=longlat +ellps=WGS84\",\n             keepgeom = TRUE)\n\n# Project GBIF \ngbif.v &lt;- project(gbif.v, crs(base.5k))\n\n# Remove occurrences outside the canada polygon\ngbif.v = terra::crop(gbif.v, canada)\n\nNow we can convert the GBIF data into raster layers:\n\ngbif.density: count of GBIF observations per cell\nmuseum.density: count of GBIF observations from preserved specimens (museums) per cell\niNat.density: count of GBIF observations from iNaturalist (dataset key: \"50c9509d-22c7-4a22-a47d-8c48425ef4a7\") per cell\nyear.last.sampled: year of the last GBIF observation in GBIF per cell\n\n\n# Make a GBIF density layer\ngbif.density &lt;- rasterize(gbif.v, base.5k, fun=\"count\")\n\n# Density of museum observations\nmuseum.density &lt;- rasterize(gbif.v[which(gbif.v$basisOfRecord == \"PRESERVED_SPECIMEN\")], base.5k, fun=\"count\")\n\n# Density of observations from iNaturalist alone\niNat.density &lt;- rasterize(gbif.v[which(gbif.v$datasetKey == \"50c9509d-22c7-4a22-a47d-8c48425ef4a7\")], base.5k, fun=\"count\")\n\n# Raster of the latest observation's year\nyear.last.sampled &lt;- rasterize(gbif.v, base.5k, fun=\"max\", field=\"year\")\n\n# Stack the GBIF layers into one object for easy saving\ngbif.layers = c(gbif.density,museum.density,iNat.density,year.last.sampled)\nnames(gbif.layers) = c(\"gbif.density\",\"museum.density\",\"iNat.density\",\"year.last.sampled\")\ngbif.layers[is.na(base.5k)]&lt;-NA\n\n# save\nwriteRaster(gbif.layers,\"data/processed/gbif.layers.amphibians.tif\", overwrite = TRUE)\nwriteVector(gbif.v,\"data/processed/gbif.points.amphibians.shp\", overwrite = TRUE)"
  },
  {
    "objectID": "tutorial.html#step-2.-prepare-environmental-human-access-layers",
    "href": "tutorial.html#step-2.-prepare-environmental-human-access-layers",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "Many of these layers are originally from the GEOBON STAC catalog, which can be viewed here: https://stac.geobon.org/viewer/. Instructions about how to retrieve these layers and download them for use are here: Working with STAC.\nThis is some code to reproject and resample the rasters from the STAC to match the GBIF density layers, after downloading them following the instructions linked above.\n\n\nClimate velocity (a metric of how quickly the climate will change by 2085 in each cell, under RCP85):\n\nvel &lt;- rast(\"data/raw/base-layers/climatevelocity_adaptwest_fwvel_ensemble_rcp85_2085.tif\")\nvel&lt;-project(vel,base.5k,\"bilinear\")\nvel&lt;-resample(vel,base.5k,method='near')\nvel[is.na(base.5k)] &lt;- NA\nterra::writeRaster(vel, \"data/processed/base-layers/climatevelocity_adaptwest_fwvel_ensemble_rcp85_2085.tif\")\n\n\n\n\nDistance to roads:\n\ndist.to.roads&lt;-rast(\"data/raw/base-layers/distance.to.roads.tif\")\ndist.to.roads&lt;-project(dist.to.roads,base.5k,\"bilinear\")\ndist.to.roads[is.na(base.5k)]&lt;-NA\nterra::writeRaster(dist.to.roads, \"data/processed/base-layers/dist.to.roads.tif\")"
  },
  {
    "objectID": "tutorial.html#step-3.-make-a-priority-map",
    "href": "tutorial.html#step-3.-make-a-priority-map",
    "title": "Making priority maps for Blitz the Gap",
    "section": "",
    "text": "# Copy the layer into a new object that we'll edit\nresamp &lt;- gbif.layers$year.last.sampled\nmapview(resamp, \n        na.color = \"transparent\")\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\nNext, we will assign priority values to cells based on the year they were last sampled. These are the priority levels we will use:\n\n\n\nPriority\nOldest observation\nNewest observation\n\n\n\n\nHigh (1)\noldest\n1950\n\n\nMedium (2)\n1951\n2000\n\n\nLow (3)\n2001\n2015\n\n\nNot a priority (4)\n2016\n2025\n\n\n\nLet’s assign these values based on the condition that the year last sampled in GBIF is within those year limits:\n\nresamp[gbif.layers$year.last.sampled &lt;= 1950] &lt;- 1\nresamp[gbif.layers$year.last.sampled &gt; 1950 & gbif.layers$year.last.sampled &lt;= 2000] &lt;- 2\nresamp[gbif.layers$year.last.sampled &gt; 2000 & gbif.layers$year.last.sampled &lt;= 2015] &lt;- 3\nresamp[gbif.layers$year.last.sampled &gt; 2015] &lt;- 4\n\nLet’s map this to see what we’re working with!\n\nmapview(resamp)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\n\n\n\nLet’s make a mask of the pixels we consider to be accessible. Let’s say anything within 10 km of a major road is potentially accessible, so we’re only interested in these cells:\n\nd10 = dist.to.roads\nd10[d10&gt;10000] &lt;- NA # assign NA to pixels that are over 10 km away from a major road\nmapview(d10)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\nNow, we can use this same condition (ignore anything where dist.to.roads &gt; 10000) to select cells from the priority layer that are accessible:\n\npal = viridis::viridis(n = 3, direction = -1)\npriority = resamp\npriority[dist.to.roads &gt; 10000] &lt;- NA\nmapview(priority, \n        col.regions = pal)\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 986203 to avoid this.\n\n\n\n\n\n\n\n\n\nLet’s visualize this a little differently, so it is easier to explore. We will make a point layer with the year in which the cell was last sampled, and this layer is resized as we zoom in and out so it is easier to have a quick view of the map. When we zoom in, we will see the cell the point is referring to, so we make sure we’re still identifying the exact cell outline that we’d be asking people to go sample.\n\nlast.year = gbif.layers$year.last.sampled\nlast.year[priority &gt; 3] &lt;- NA\nlast.year[dist.to.roads &gt; 10000] &lt;- NA\n\nhistorical_pts = last.year |&gt;\n  raster::raster() |&gt;\n  raster::rasterToPoints(fun = function(x){x&lt;2016}, spatial = TRUE)\n\nhistorical_cells = priority |&gt;\n  raster::raster() |&gt;\n  raster::rasterToPolygons(fun = function(x){x &lt; 4})\n\npal = viridis::viridis(n = 3, direction = -1)\n(m = mapview(historical_cells, \n        legend = TRUE, \n        basemaps = \"OpenStreetMap\",  \n        col.regions = pal,\n        layer.name = \"Priority\") +\n  mapview(historical_pts,\n          col.regions = pal,\n          legend = FALSE, \n          layer.name = \"Year last \\nsampled\"))\n\nWarning: Found less unique colors (3) than unique zcol values (80)! \nInterpolating color vector to match number of zcol values.\n\n\n\n\n\n\n\nhtmlwidgets::saveWidget(m@map, \n                        file = \"challenges/maps/challenge1_map.html\", \n                        title = \"Revisit the past: Amphibians\")"
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html",
    "href": "challenges/challenge1_revisit-the-past.html",
    "title": "Revisiting the past",
    "section": "",
    "text": "To understand biodiversity change, we need a record of biodiversity change. Join this challenge to help us bridge time gaps in biodiversity data!\nSome of the most valuable information we have from the past is from naturalists who spent hours in the field, looking for species they love. Unfortunately, fewer and fewer of us can invest our lives into observing nature in this way, though we may share a passion for nature and the outdoors. Gaps are appearing not just in space, but also in time: as data gets older, we become less certain that the species is still there. By revisiting past observations, we can better understand how biodiversity is changing to prevent biodiversity losses."
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html#whats-the-problem",
    "href": "challenges/challenge1_revisit-the-past.html#whats-the-problem",
    "title": "Revisiting the past",
    "section": "",
    "text": "To understand biodiversity change, we need a record of biodiversity change. Join this challenge to help us bridge time gaps in biodiversity data!\nSome of the most valuable information we have from the past is from naturalists who spent hours in the field, looking for species they love. Unfortunately, fewer and fewer of us can invest our lives into observing nature in this way, though we may share a passion for nature and the outdoors. Gaps are appearing not just in space, but also in time: as data gets older, we become less certain that the species is still there. By revisiting past observations, we can better understand how biodiversity is changing to prevent biodiversity losses."
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html#where-should-you-go",
    "href": "challenges/challenge1_revisit-the-past.html#where-should-you-go",
    "title": "Revisiting the past",
    "section": "Where should you go?",
    "text": "Where should you go?\nTo bridge this gap, we encourage you to revisit places that were sampled in the past. We’ve highlighted historically-sampled places that are close to roads for you to choose from, which you can see on these maps:"
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html#amphibians",
    "href": "challenges/challenge1_revisit-the-past.html#amphibians",
    "title": "Revisiting the past",
    "section": "Amphibians",
    "text": "Amphibians"
  },
  {
    "objectID": "challenges/challenge1_revisit-the-past.html#who-created-this-challenge",
    "href": "challenges/challenge1_revisit-the-past.html#who-created-this-challenge",
    "title": "Revisiting the past",
    "section": "Who created this challenge?",
    "text": "Who created this challenge?\nThis challenge was the first one created for Blitz the Gap, designed by Laura Pollock, Isaac Eckert, Pierre Rogy, and Katherine Hébert. We are all part of the Quantitative Biodiversity Lab at McGill University led by Laura. We use data from sources like iNaturalist to build biodiversity models that help us understand and predict biodiversity and how it is changing."
  }
]